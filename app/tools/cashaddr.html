{% extends 'base.njk' %}

{% block title %}CashAddress converter{% endblock %}

{% block body %}

<section class="hero-alt">
  {% include "navbar.njk" %}

  <div class="container py-6 text-white text-center text-md-left">
    <h1 class="font-weight-bold">CashAddress converter</h1>
    <p class="h3 text-muted">CashAddress - Legacy address format conversion tool</p>

    <!-- Input form -->
    <div class="row mt-6">
      <div class="col-12 col-lg-10 form-inline">
        <input id="address" class="form-control form-control-lg no-round-right col-8 shadow-sm" type="text" placeholder="Paste an address here">
        <button class="btn btn-primary btn-lg no-round-left col-4" onclick="convertAddress()">Convert</button>
      </div>
    </div>

    <!-- Error message -->
    <div class="mt-3 text-left">
      <p class="text-danger d-none text-break" id="errorMessage">This is not a valid address</p>
    </div>

    <!-- Converted address -->
    <div class="mt-3 text-left text-break d-none" id="convertedAddr">
      <p id="cashAddr">Address</p>
      <p id="legacyAddr">Legacy</p>
    </div>

  </div>
</section>

<script src="/static/js/bchaddrjs-0.4.9.min.js"></script>

<script>
  function convertAddress() {
    const address = $("#address").val();
    if (address) {
      if (bchaddr.isValidAddress(address)) {
        $("#errorMessage").addClass("d-none");
        // Conversion
        const cash = bchaddr.toCashAddress(address);
        const legacy = bchaddr.toLegacyAddress(address);
        // Replace values
        $("#cashAddr").text(cash);
        $("#legacyAddr").text(legacy);
        // Display converted address
        $("#convertedAddr").removeClass("d-none");
      } else {
        // Show error message
        $("#convertedAddr").addClass("d-none");
        $("#errorMessage").removeClass("d-none");
        $("#errorMessage").text(address + " is not a valid address");
      }
    }
  }
</script>
{% endblock %}
